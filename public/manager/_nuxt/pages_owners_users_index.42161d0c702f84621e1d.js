webpackJsonp([8],{"07sv":function(t,e,s){var a=s("rpnb"),r=s("CxPB"),n=s("t8rQ");t.exports=function(t,e){return null==t?t:a(t,r(e),n)}},"0X/x":function(t,e,s){"use strict";var a=s("Dd8w"),r=s.n(a),n=s("NYxO"),i=s("YtWf"),o=s("Eoz/"),l=s.n(o),c=s("YVPM"),u=s.n(c),d=new Date,p=u()(d,1),h=[l()(d,"YYYY-MM-DD"),l()(p,"YYYY-MM-DD"),""];e.a={name:"UserFilter",watch:{"search.criteria":function(){this.setNeedRefresh(!0)}},created:function(){this.setDateFilter()},methods:r()({setDateFilter:function(){var t=this;this.$nextTick(function(){t.setSearch({value:h[t.search.toggleValue1],path:"localDateCriteria"}),t.searchListDelegate().then(function(){t.setNeedRefresh(!1)})})}},Object(n.mapMutations)("terms",["setNeedRefresh"]),Object(n.mapMutations)("owners/users",["setSearch"]),Object(n.mapActions)("owners/users",["searchList","searchListDelegate"]),{onReload:function(){var t=this;this.$nextTick(function(){t.searchListDelegate().then(function(){t.setNeedRefresh(!1)})})}}),computed:r()({criteria:Object(i.d)("owners/users/search@criteria"),dateFilter:Object(i.b)("owners/users/search@toggleValue1")},Object(n.mapState)("owners/users",["list","exportFilter","search"]))}},"2pDn":function(t,e,s){var a=s("V8c7");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);s("rjj0")("0ffaef15",a,!0,{sourceMap:!1})},"86Ep":function(t,e,s){"use strict";var a=s("Dd8w"),r=s.n(a),n=s("NYxO"),i=s("07sv"),o=s.n(i);e.a={name:"TreatmentsFilter",data:function(){return{mandatoryTermFilter:[],filter:{person:"",treatments:{},language:""}}},methods:r()({onReload:function(){this.searchListDelegate(),this.setNeedRefresh(!1)},onTermChange:function(t,e){if(t.selected)e.selected=!0;else{var s=this.selectedTermsCount(e);e.selected=s>0}this.onChange(e)},onTreatmentChange:function(t){t.selected?this.setSelectAllTerms(t.terms,!0):this.setSelectAllTerms(t.terms,!1),this.onChange(t)}},Object(n.mapActions)("owners/users",["searchListDelegate"]),Object(n.mapMutations)("owners/users",["setExportFilter","setExportFilterTreatments"]),Object(n.mapMutations)("terms",["setNeedRefresh"]),{setSelectAllTerms:function(t,e){o()(t,function(t){t.selected=e})},onChange:function(t){this.updateTreatment(t)},updateTreatment:function(t){this.filter.treatments[t.code]=t,this.setNeedRefresh(!0),this.exportTreatments()},exportTreatments:function(){this.setExportFilterTreatments(this.filter.treatments)},selectedTermsCount:function(t){return t.terms.reduce(function(t,e){return e.selected&&t++,e.selected?t++:t},0)}}),created:function(){this.mandatoryTermFilter=this.termFilter,this.filter.treatments=this.mandatoryTermFilter,this.exportTreatments()},computed:r()({},Object(n.mapState)("terms",["termFilter","search"]))}},"8Qov":function(t,e,s){"use strict";var a=s("phVV"),r=s("nhZJ"),n=s("VU/8")(a.a,r.a,!1,null,null,null);e.a=n.exports},BEFF:function(t,e,s){"use strict";var a=s("//Fk"),r=s.n(a),n=s("NUKO");e.a={components:{UserManager:n.a},fetch:function(t){var e=t.store,s=e.state.owners.users.useCache,a=e.state.owners.users.inited;if(e.dispatch("treatments/load",{},{root:!0}),e.dispatch("terms/load",{},{root:!0}),!s){var n=[e.dispatch("terms/loadFilter",{},{root:!0})];return a||n.push(e.dispatch("owners/users/init",{},{root:!0})),r.a.all(n).then(function(){e.dispatch("owners/users/searchListDelegate",null,{root:!0}).then(function(){return e.commit("owners/users/setUseCache",!0,{root:!0})})})}}}},CxPB:function(t,e,s){var a=s("wSKX");t.exports=function(t){return"function"==typeof t?t:a}},JDMG:function(t,e,s){"use strict";var a={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-dialog",{attrs:{persistent:"","max-width":"290"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[s("v-toolbar",{attrs:{dense:"",color:"blue",dark:""}},[s("v-toolbar-title",{staticClass:"subheading"},[s("v-icon",[t._v("alternate_email")]),t._v("\n            "+t._s(t.$t("Share list"))+" - "+t._s(t.$t(t.adapter))+"\n        ")],1)],1),s("v-card",{staticClass:"pa-3"},[s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{attrs:{xs12:""}},[s("v-form",{ref:"exportform",attrs:{enctype:"text/plain",target:"_blank",method:"POST"}},[s("v-text-field",{attrs:{"prepend-icon":"description",label:t.$t("List name"),box:""},model:{value:t.contactlistName,callback:function(e){t.contactlistName=e},expression:"contactlistName"}}),s("input",{directives:[{name:"model",rawName:"v-model",value:t.jsonParams,expression:"jsonParams"}],attrs:{type:"hidden",name:"json"},domProps:{value:t.jsonParams},on:{input:function(e){e.target.composing||(t.jsonParams=e.target.value)}}})],1)],1)],1),s("v-card-actions",[s("a",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]}),s("v-spacer"),s("v-btn",{staticClass:"elevation-1",nativeOn:{click:function(e){return t.onCancel(e)}}},[t._v(t._s(t.$t("Cancel")))]),s("v-btn",{staticClass:"elevation-1",attrs:{disabled:!t.contactlistName},nativeOn:{click:function(e){return t.onExport(e)}}},[s("v-icon",[t._v("cloud_download")]),s("span",{staticClass:"ml-2"},[t._v(t._s(t.$t("Share")))])],1)],1)],1)],1)},staticRenderFns:[]};e.a=a},K40v:function(t,e,s){"use strict";var a=s("zyW9"),r=s("V6/M");var n=function(t){s("2pDn")},i=s("VU/8")(a.a,r.a,!1,n,null,null);e.a=i.exports},LBBD:function(t,e,s){"use strict";var a=s("0X/x"),r=s("MIXe");var n=function(t){s("sIXI")},i=s("VU/8")(a.a,r.a,!1,n,null,null);e.a=i.exports},"LBi/":function(t,e,s){"use strict";var a=s("lEY4"),r=s("JDMG"),n=s("VU/8")(a.a,r.a,!1,null,null,null);e.a=n.exports},MIXe:function(t,e,s){"use strict";var a={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-layout",{staticClass:"user-filter",attrs:{row:"",wrap:"","align-baseline":""}},[s("v-flex",{attrs:{xs9:"",sm5:""}},[s("v-text-field",{attrs:{"append-icon":"search",box:"",color:"silver","hide-details":"",label:t.$t("Surname, Name, Email")},model:{value:t.criteria,callback:function(e){t.criteria=e},expression:"criteria"}})],1),s("v-flex",{attrs:{xs3:"",sm1:""}},[t._e()],1),s("v-flex",{attrs:{xs12:"",sm5:""}},[s("v-btn-toggle",{staticClass:"user-filter-toggle elevation-0 ",staticStyle:{position:"relative",top:"4px"},model:{value:t.search.toggleValue1,callback:function(e){t.$set(t.search,"toggleValue1",e)},expression:"search.toggleValue1"}},[s("v-btn",{staticClass:"user-filter-date-toggle",attrs:{flat:"",disabled:0==t.dateFilter},on:{click:t.setDateFilter}},[s("v-icon",{staticClass:"mr-1"},[t._v("today")]),s("span",{domProps:{textContent:t._s(t.$t("Today"))}})],1),s("v-btn",{staticClass:"user-filter-date-toggle",attrs:{flat:"",disabled:1==t.dateFilter},on:{click:t.setDateFilter}},[s("v-icon",{staticClass:"mr-1"},[t._v("calendar_today")]),s("span",{domProps:{textContent:t._s(t.$t("Yesterday"))}})],1),s("v-btn",{staticClass:"user-filter-date-toggle",attrs:{flat:"",disabled:2==t.dateFilter},on:{click:t.setDateFilter}},[s("v-icon",{staticClass:"mr-1"},[t._v("all_inclusive")]),s("span",{domProps:{textContent:t._s(t.$t("All"))}})],1)],1)],1)],1)},staticRenderFns:[]};e.a=a},NUKO:function(t,e,s){"use strict";var a=s("hJJ5"),r=s("PDSs"),n=s("VU/8")(a.a,r.a,!1,null,null,null);e.a=n.exports},PDSs:function(t,e,s){"use strict";var a={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-container",{attrs:{fluid:""}},[s("ShareListDialog",{attrs:{show:t.showShareDialog,adapter:t.adapter},on:{cancel:t.hideShareDialog}}),s("v-layout",{attrs:{row:"",wrap:""}},[s("div",{staticClass:"headline"},[t._v(t._s(t.$t("Users")))]),s("v-spacer"),s("v-menu",{attrs:{origin:"center center",transition:"scale-transition",bottom:""}},[s("v-btn",{staticClass:"elevation-0",staticStyle:{"text-transform":"uppercase"},attrs:{slot:"activator",dark:"",color:"indigo lighten-1",dark:""},slot:"activator"},[t._v("\n                "+t._s(t.$t("Share list"))+"\n            ")]),s("v-list",t._l(t.shareMenuItems,function(e,a){return s("v-list-tile",{key:a,on:{click:function(t){}}},[s("v-list-tile-title",{on:{click:function(s){t.onShowShareList(e.adapter)}}},[t._v(t._s(t.$t(e.title)))])],1)}))],1)],1),s("v-layout",{staticClass:"mb-3"},[s("UserFilter")],1),s("div",{staticClass:"title mb-2"},[t._v(t._s(t.$t("Filter users according to accepted regulations")))]),s("v-layout",{staticClass:"mb-4"},[s("TreatmentsFilter")],1),s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{attrs:{xs12:""}},[s("UsersGrid")],1)],1)],1)},staticRenderFns:[]};e.a=a},R3aR:function(t,e,s){(t.exports=s("FZ+f")(!1)).push([t.i,"",""])},UR2r:function(t,e,s){"use strict";var a={render:function(){var t=this.$createElement;return(this._self._c||t)("UserManager")},staticRenderFns:[]};e.a=a},"V6/M":function(t,e,s){"use strict";var a={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.formFilterValidList.length>0?s("v-layout",{staticClass:"subheading mb-2"},[s("b",[t._v(t._s(t.$t("Users found"))+" "+t._s(t.formFilterValidList.length))])]):t._e(),s("v-data-table",t._b({staticClass:"elevation-1 surfers-list-table",attrs:{headers:t.headers,items:t.formFilterValidList,pagination:t.grid.pagination,_search:"search.criteria",loading:t.isAjax,"sort-icon":"keyboard_arrow_down","no-data-text":t.$t("No user found")+" "+t.dateFilterText},on:{"update:pagination":function(e){t.$set(t.grid,"pagination",e)}},scopedSlots:t._u([{key:"items",fn:function(e){return[s("tr",[s("td",[s("v-icon",{staticClass:"mr-2 pa-0"},[t._v("cloud_done")]),s("span",{staticStyle:{position:"relative",top:"2px"}},[t._v(t._s(t._f("dmy")(e.item.created)))])],1),s("td",[s("b",[t._v(t._s(e.item.email))]),s("br"),t._v("\n                    "+t._s(e.item.domain+e.item.site)+"\n                ")]),s("td",[t._v(" "+t._s(e.item.surname)+" ")]),s("td",[t._v(t._s(e.item.name))]),s("td",{staticClass:"justify-center layout px-0"},[s("nuxt-link",{attrs:{to:"/owners/users/"+t.encodedId(e.item.email)+"?mode=edit"}},[s("v-tooltip",{attrs:{left:""}},[s("v-btn",{staticClass:"pa-0 ma-0",attrs:{slot:"activator",flat:"",small:"",icon:"",color:"blue"},slot:"activator"},[s("v-icon",[t._v("edit")])],1),s("span",[t._v(t._s(t.$t("Edit user")))])],1)],1),t._e(),t._e()],1)])]}},{key:"expand",fn:function(e){var a=e.item;return[s("v-card",{attrs:{flat:""}},[s("v-card-text",{},[t._v("Ip: "+t._s(a.ip))]),t._l(a.privacyFlags,function(e,a){return s("v-card-text",{key:a,staticClass:"py-0 my-0"},[e.selected?s("v-icon",[t._v("check_box")]):s("v-icon",[t._v("check_box_outline_blank")]),t._v("\n                    "+t._s(e.code)+"\n                ")],1)}),s("v-card-text")],2)]}},{key:"pageText",fn:function(e){var s=e.pageStart,a=e.pageStop;return[t._v("\n            "+t._s(t.$t("From"))+" "+t._s(s)+" "+t._s(t.$t("To"))+" "+t._s(a)+"\n        ")]}}])},"v-data-table",t.tableTexts,!1),[s("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1)],1)},staticRenderFns:[]};e.a=a},V8c7:function(t,e,s){(t.exports=s("FZ+f")(!1)).push([t.i,".surfers-list-table tr{cursor:pointer}.surfers-list-table td{cursor:pointer;padding-right:0!important}.surfers-list-table td .btn{height:26px!important;width:26px}.surfers-list-table table.table tbody td,.surfers-list-table table.table tbody th,.surfers-list-table table.table thead tr{height:32px;font-size:12px}",""])},a0OY:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("BEFF"),r=s("UR2r");var n=function(t){s("hgPx")},i=s("VU/8")(a.a,r.a,!1,n,null,null);e.default=i.exports},gTC0:function(t,e,s){"use strict";var a=s("86Ep"),r=s("iKsL");var n=function(t){s("vlue")},i=s("VU/8")(a.a,r.a,!1,n,null,null);e.a=i.exports},hJJ5:function(t,e,s){"use strict";var a=s("Dd8w"),r=s.n(a),n=s("gTC0"),i=s("LBBD"),o=s("K40v"),l=s("LBi/"),c=s("8Qov"),u=s("NYxO"),d=s("L8MQ"),p=s.n(d);e.a={name:"UserManager",methods:r()({},Object(u.mapActions)("owners/users",["searchList"]),{onShowShareList:function(t){this.adapter=t,this.showShareDialog=!0},onSearch:function(){this.exportFilter.treatments=p()(this.exportFilter.treatments).filter(function(t){return t.selected}),this.searchList(this.exportFilter)},hideShareDialog:function(){this.showShareDialog=!1}}),computed:r()({},Object(u.mapState)("owners/users",["exportFilter"])),data:function(){return{selectedExportMenuItem:null,showShareDialog:!1,toggleTemporaryFilter:1,adapter:"csv",shareMenuItems:[{title:"Csv Export",adapter:"csv"},{title:"Mailone Export",adapter:"mailone"}]}},components:{GridSearchBar:c.a,ShareListDialog:l.a,TreatmentsFilter:n.a,UserFilter:i.a,UsersGrid:o.a}}},hgPx:function(t,e,s){var a=s("R3aR");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);s("rjj0")("27466516",a,!0,{sourceMap:!1})},iKsL:function(t,e,s){"use strict";var a={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-layout",{staticClass:"treatment-filter ",attrs:{column:""}},[s("div",{staticClass:"blue-grey lighten-5"},[s("v-layout",{attrs:{row:"",wrap:""}},t._l(t.mandatoryTermFilter,function(e,a){return s("v-flex",{key:a,staticClass:"py-2 left-bordered",attrs:{xs12:"",sm4:""}},[s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{staticClass:"pl-2",attrs:{xs12:""}},[s("span",{staticClass:"treatment-flag"},[s("v-checkbox",{staticClass:"treatment-flag-checkbox",attrs:{color:"blue darken-1","hide-details":"",small:"",label:e.name},on:{change:function(s){t.onTreatmentChange(e)}},model:{value:e.selected,callback:function(s){t.$set(e,"selected",s)},expression:"treatment.selected"}})],1)])],1),t._l(e.terms,function(a,r){return[s("v-layout",{key:r,staticClass:"pl-4",attrs:{row:"",wrap:""}},[s("v-flex",{attrs:{xs1:""}},[s("v-checkbox",{staticClass:"treatment-flag-checkbox",attrs:{color:"blue darken-1","hide-details":"",small:"",_label:"term.name"},on:{change:function(s){t.onTermChange(a,e)}},model:{value:a.selected,callback:function(e){t.$set(a,"selected",e)},expression:"term.selected"}})],1),s("v-flex",{staticClass:"caption pr-3",attrs:{xs11:""}},[s("div",{staticClass:"pl-2"},[s("v-divider"),t._v("\n                                "+t._s(a.name)+"\n                            ")],1)])],1)]})],2)}))],1),t.search.needRefresh?s("v-layout",{attrs:{column:""}},[s("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[s("v-btn",{attrs:{flat:""},on:{click:t.onReload}},[s("span",[t._v(t._s(t.$t("Click here to refresh")))]),s("v-icon",[t._v("replay")])],1)],1)],1):t._e()],1)},staticRenderFns:[]};e.a=a},lEY4:function(t,e,s){"use strict";var a=s("mvHQ"),r=s.n(a),n=s("Dd8w"),i=s.n(n),o=s("NYxO"),l=s("Eoz/"),c=s.n(l),u=s("lbHh"),d=s.n(u),p=s("jLWv"),h=s("/5sW"),f=s("L8MQ"),m=s.n(f),v=s("z1+p"),x=s.n(v);e.a={name:"ShareListDialog",watch:{show:function(){this.contactlistName=this.contactlistFileName}},computed:i()({},Object(o.mapState)("owners/users",["exportFilter"]),{contactlistFileName:function(){var t=c()(new Date,"YYYYMMDDTHHmmss"),e=".csv";return"mailone"===this.adapter&&(e=""),this.adapter+"-"+t+e}}),methods:i()({},Object(o.mapActions)("owners/users",["prepareExportList"]),{onCancel:function(){this.$emit("cancel")},onExport:function(){"csv"===this.adapter?this.onExportCsv():"mailone"===this.adapter&&this.onExportMailOne()},completeExportRequest:function(){return this.exportFilter.treatments=m()(this.exportFilter.treatments).filter(function(t){return t.selected}),{adapter:this.adapter,contactlistname:this.contactlistName,contactlistemail:"",contactlistreplytoemail:"",filter:this.exportFilter}},onExportMailOne:function(){var t=this,e=this.completeExportRequest();this.prepareExportList(e).then(function(e){t.$store.dispatch("api/post",e,{root:!0}).then(function(){}),x()(t.onCancel,10)})},onExportCsv:function(){var t=this,e=this.$auth.getToken(Object(p.a)()),s=e.split("bearer ");if(s.length>0){e=s[1],d.a.set("token",e);var a=this.completeExportRequest();this.prepareExportList(a).then(function(e){t.jsonParams=r()(e.data),t.$refs.exportform.$el.action=e.url,h.default.nextTick(function(){t.$refs.exportform.$el.submit(),t.onCancel()})})}else alert(this.$t("Error"))}}),mounted:function(){this.contactlistName=this.exportFileName},data:function(){return{jsonParams:null,contactlistName:""}},props:{show:{default:!1},adapter:{default:"csv"}}}},nhZJ:function(t,e,s){"use strict";var a={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-toolbar",{staticClass:"py-0 px-4  elevation-1",attrs:{dense:"",color:"white"}},[s("v-text-field",{attrs:{disabled:0==t.list.length,"append-icon":"search",label:t.$t("Filter result set"),"single-line":"","hide-details":""},model:{value:t.search.localCriteria,callback:function(e){t.$set(t.search,"localCriteria",e)},expression:"search.localCriteria"}})],1)},staticRenderFns:[]};e.a=a},phVV:function(t,e,s){"use strict";var a=s("Dd8w"),r=s.n(a),n=s("NYxO");e.a={name:"GridSearchBar",computed:r()({},Object(n.mapState)("owners/users",["list","search","grid"]),Object(n.mapState)("api",["isAjax"]))}},sIXI:function(t,e,s){var a=s("vZGT");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);s("rjj0")("2d9994e0",a,!0,{sourceMap:!1})},vZGT:function(t,e,s){(t.exports=s("FZ+f")(!1)).push([t.i,".user-filter-toggle{border:1px solid #e2e2e2}.user-filter-date-toggle.btn--active{background-color:#eee!important;pointer-events:none}",""])},vlue:function(t,e,s){var a=s("zoat");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);s("rjj0")("5e765450",a,!0,{sourceMap:!1})},zoat:function(t,e,s){(t.exports=s("FZ+f")(!1)).push([t.i,".left-bordered{border-right:1px solid #e1e1e1}.treatment-flag-checkbox .input-group--selection-controls__ripple{height:24px;width:24px;left:9px}.treatment-flag-checkbox label{font-size:12px;line-height:20px;color:rgba(0,0,0,.8)!important}.treatment-flag-checkbox .icon{font-size:18px}.treatment-flag-checkbox .input-group--text-field-box .input-group__input,.treatment-flag-checkbox .input-group__input{min-height:20px}",""])},zyW9:function(t,e,s){"use strict";var a=s("Dd8w"),r=s.n(a),n=s("NYxO");t="owners/users";e.a={name:"UsersGrid",methods:{encodedId:function(t){return encodeURI(btoa(t))}},data:function(){var e=[{text:this.$t("Last subscription"),value:"created",width:"100px"},{text:this.$t("Email")+"/"+this.$t("Page"),value:"email"},{text:this.$t("Surname"),value:"surname"},{text:this.$t("Name"),value:"name"},{text:this.$t("Actions"),value:"action"}];return{formDateFilter:"",tableTexts:{rowsPerPageText:this.$t("Rows per page"),rowsPerPageItems:[10,20,50,{text:this.$t("All"),value:-1}]},module:t,headers:e}},computed:r()({},Object(n.mapGetters)(t,["filterListByDate"]),Object(n.mapState)(t,["list","search","grid"]),Object(n.mapState)("api",["isAjax"]),{dateFilterText:function(){return 0===this.search.toggleValue1?this.$t("Today"):1===this.search.toggleValue1?this.$t("Yesterday"):""},formFilterValidList:function(){return this.validList},validList:function(){return this.filterListByDate.filter?this.filterListByDate.filter(function(t){return t.email&&t.email.includes("@")}):[]}})}}});