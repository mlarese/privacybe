webpackJsonp([6],{"+VHq":function(t,e,a){"use strict";var s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.formFilterValidList.length>0?a("v-layout",{staticClass:"subheading mb-2"},[a("b",[t._v(t._s(t.$t("Users found"))+" "+t._s(t.formFilterValidList.length))])]):t._e(),a("v-data-table",t._b({staticClass:"elevation-1 surfers-list-table",attrs:{headers:t.headers,items:t.formFilterValidList,pagination:t.grid.pagination,search:t.search.criteria,loading:t.isAjax,"sort-icon":"keyboard_arrow_down","no-data-text":t.$t("No user found")},on:{"update:pagination":function(e){t.$set(t.grid,"pagination",e)}},scopedSlots:t._u([{key:"items",fn:function(e){return[a("tr",[a("td",[a("v-icon",{staticClass:"mr-2 pa-0"},[t._v("cloud_done")]),a("span",{staticStyle:{position:"relative",top:"2px"}},[t._v(t._s(t._f("dmy")(e.item.created)))])],1),a("td",[t._v("\n                    "+t._s(e.item.email)+"\n                ")]),a("td",[t._v(" "+t._s(e.item.surname)+" ")]),a("td",[t._v(t._s(e.item.name))]),a("td",{staticClass:"justify-center layout px-0"},[a("nuxt-link",{attrs:{to:"/owners/users/"+t.encodedId(e.item.email)+"?mode=edit"}},[a("v-tooltip",{attrs:{left:""}},[a("v-btn",{staticClass:"pa-0 ma-0",attrs:{slot:"activator",flat:"",small:"",icon:"",color:"blue"},slot:"activator"},[a("v-icon",[t._v("edit")])],1),a("span",[t._v(t._s(t.$t("Edit user")))])],1)],1),t._e(),t._e()],1)])]}},{key:"expand",fn:function(e){var s=e.item;return[a("v-card",{attrs:{flat:""}},[a("v-card-text",{},[t._v("Ip: "+t._s(s.ip))]),t._l(s.privacyFlags,function(e,s){return a("v-card-text",{key:s,staticClass:"py-0 my-0"},[e.selected?a("v-icon",[t._v("check_box")]):a("v-icon",[t._v("check_box_outline_blank")]),t._v("\n                    "+t._s(e.code)+"\n                ")],1)}),a("v-card-text")],2)]}},{key:"pageText",fn:function(e){var a=e.pageStart,s=e.pageStop;return[t._v("\n            "+t._s(t.$t("From"))+" "+t._s(a)+" "+t._s(t.$t("To"))+" "+t._s(s)+"\n        ")]}}])},"v-data-table",t.tableTexts,!1),[a("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1)],1)},staticRenderFns:[]};e.a=s},"07sv":function(t,e,a){var s=a("rpnb"),r=a("CxPB"),n=a("t8rQ");t.exports=function(t,e){return null==t?t:s(t,r(e),n)}},"0X/x":function(t,e,a){"use strict";var s=a("Dd8w"),r=a.n(s),n=a("NYxO"),i=a("YtWf"),o=a("Eoz/"),l=a.n(o),c=a("YVPM"),u=a.n(c),d=new Date,p=u()(d,1),f=["",l()(d,"YYYY-MM-DD"),l()(p,"YYYY-MM-DD")];e.a={name:"UserFilter",created:function(){this.setDateFilter()},methods:r()({setDateFilter:function(){var t=this;this.$nextTick(function(){t.search.localDateCriteria=f[t.search.toggleValue1]})}},Object(n.mapMutations)("terms",["setNeedRefresh"]),Object(n.mapActions)("owners/users",["searchList","searchListDelegate"]),{onReload:function(){var t=this;this.searchListDelegate().then(function(){t.setNeedRefresh(!1)})}}),computed:r()({criteria:Object(i.c)("owners/users/search@criteria")},Object(n.mapState)("owners/users",["list","exportFilter","search"]))}},"2zeN":function(t,e,a){var s=a("tHj3");"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a("rjj0")("48a5990a",s,!0,{sourceMap:!1})},"86Ep":function(t,e,a){"use strict";var s=a("Dd8w"),r=a.n(s),n=a("NYxO"),i=a("07sv"),o=a.n(i);e.a={name:"TreatmentsFilter",data:function(){return{mandatoryTermFilter:[],filter:{person:"",treatments:{},language:""}}},methods:r()({onReload:function(){this.searchListDelegate(),this.setNeedRefresh(!1)},onTermChange:function(t,e){if(t.selected)e.selected=!0;else{var a=this.selectedTermsCount(e);e.selected=a>0}this.onChange(e)},onTreatmentChange:function(t){t.selected?this.setSelectAllTerms(t.terms,!0):this.setSelectAllTerms(t.terms,!1),this.onChange(t)}},Object(n.mapActions)("owners/users",["searchListDelegate"]),Object(n.mapMutations)("owners/users",["setExportFilter"]),Object(n.mapMutations)("terms",["setNeedRefresh"]),{setSelectAllTerms:function(t,e){o()(t,function(t){t.selected=e})},onChange:function(t){this.filter.treatments[t.code]=t,this.setNeedRefresh(!0),this.setExportFilter(this.filter)},selectedTermsCount:function(t){return t.terms.reduce(function(t,e){return e.selected&&t++,e.selected?t++:t},0)}}),created:function(){this.mandatoryTermFilter=this.termFilter,this.filter.treatments=this.mandatoryTermFilter,this.setExportFilter(this.filter)},computed:r()({},Object(n.mapState)("terms",["termFilter","search"]))}},"8Qov":function(t,e,a){"use strict";var s=a("phVV"),r=a("nhZJ"),n=a("VU/8")(s.a,r.a,!1,null,null,null);e.a=n.exports},BEFF:function(t,e,a){"use strict";var s=a("//Fk"),r=a.n(s),n=a("NUKO");e.a={components:{UserManager:n.a},fetch:function(t){var e=t.store;if(!e.state.owners.users.useCache){var a=[e.dispatch("terms/loadFilter",{},{root:!0}),e.dispatch("treatments/load",{},{root:!0})];return r.a.all(a).then(function(){e.dispatch("owners/users/searchList",{},{root:!0}).then(function(){return e.commit("owners/users/setUseCache",!0,{root:!0})})})}}}},BTVZ:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"",""])},CxPB:function(t,e,a){var s=a("wSKX");t.exports=function(t){return"function"==typeof t?t:s}},GOxW:function(t,e,a){"use strict";var s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:""}},[a("ShareListDialog",{attrs:{show:t.showShareDialog,adapter:t.adapter},on:{cancel:t.hideShareDialog}}),a("v-layout",{attrs:{row:"",wrap:""}},[a("div",{staticClass:"headline"},[t._v(t._s(t.$t("Users")))]),a("v-spacer"),a("v-menu",{attrs:{origin:"center center",transition:"scale-transition",bottom:""}},[a("v-btn",{staticClass:"elevation-0",staticStyle:{"text-transform":"uppercase"},attrs:{slot:"activator",dark:"",color:"indigo lighten-1",dark:""},slot:"activator"},[t._v("\n                "+t._s(t.$t("Share list"))+"\n            ")]),a("v-list",t._l(t.shareMenuItems,function(e,s){return a("v-list-tile",{key:s,on:{click:function(t){}}},[a("v-list-tile-title",{on:{click:function(a){t.onShowShareList(e.adapter)}}},[t._v(t._s(t.$t(e.title)))])],1)}))],1)],1),a("v-layout",{staticClass:"mb-3"},[a("UserFilter")],1),a("div",{staticClass:"title mb-2"},[t._v(t._s(t.$t("Filter users according to accepted regulations")))]),a("v-layout",{staticClass:"mb-4"},[a("TreatmentsFilter")],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("UsersGrid")],1)],1)],1)},staticRenderFns:[]};e.a=s},HFgp:function(t,e,a){var s=a("BTVZ");"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a("rjj0")("3bbc3d04",s,!0,{sourceMap:!1})},JRXP:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,".surfers-list-table td,.surfers-list-table tr{cursor:pointer}.surfers-list-table td .btn{height:26px!important;width:26px}.surfers-list-table table.table tbody td,.surfers-list-table table.table tbody th,.surfers-list-table table.table thead tr{height:32px;font-size:12px}",""])},K40v:function(t,e,a){"use strict";var s=a("zyW9"),r=a("+VHq");var n=function(t){a("qWik")},i=a("VU/8")(s.a,r.a,!1,n,null,null);e.a=i.exports},LBBD:function(t,e,a){"use strict";var s=a("0X/x"),r=a("bdDF");var n=function(t){a("2zeN")},i=a("VU/8")(s.a,r.a,!1,n,null,null);e.a=i.exports},"LBi/":function(t,e,a){"use strict";var s=a("lEY4"),r=a("YY6W"),n=a("VU/8")(s.a,r.a,!1,null,null,null);e.a=n.exports},NUKO:function(t,e,a){"use strict";var s=a("hJJ5"),r=a("GOxW"),n=a("VU/8")(s.a,r.a,!1,null,null,null);e.a=n.exports},UgkA:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,a){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var s=(0,n.default)(t,a),r=Number(e);return s.setDate(s.getDate()+r),s};var s,r=a("Sc7W"),n=(s=r)&&s.__esModule?s:{default:s};t.exports=e.default},YVPM:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,a){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var s=Number(e);return(0,n.default)(t,-s,a)};var s,r=a("UgkA"),n=(s=r)&&s.__esModule?s:{default:s};t.exports=e.default},YY6W:function(t,e,a){"use strict";var s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{persistent:"","max-width":"290"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("v-toolbar",{attrs:{dense:"",color:"blue",dark:""}},[a("v-toolbar-title",{staticClass:"subheading"},[a("v-icon",[t._v("alternate_email")]),t._v("\n            "+t._s(t.$t("Share list"))+" - "+t._s(t.$t(t.adapter))+"\n        ")],1)],1),a("v-card",{staticClass:"pa-3"},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-form",{ref:"exportform",attrs:{enctype:"text/plain",target:"_blank",method:"POST"}},[a("v-text-field",{attrs:{"prepend-icon":"description",label:t.$t("List name"),box:""},model:{value:t.contactlistName,callback:function(e){t.contactlistName=e},expression:"contactlistName"}}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.jsonParams,expression:"jsonParams"}],attrs:{type:"hidden",name:"json"},domProps:{value:t.jsonParams},on:{input:function(e){e.target.composing||(t.jsonParams=e.target.value)}}})],1)],1)],1),a("v-card-actions",[a("a",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]}),a("v-spacer"),a("v-btn",{staticClass:"elevation-1",nativeOn:{click:function(e){return t.onCancel(e)}}},[t._v(t._s(t.$t("Cancel")))]),a("v-btn",{staticClass:"elevation-1",attrs:{disabled:!t.contactlistName},nativeOn:{click:function(e){return t.onExport(e)}}},[a("v-icon",[t._v("cloud_download")]),a("span",{staticClass:"ml-2"},[t._v(t._s(t.$t("Share")))])],1)],1)],1)],1)},staticRenderFns:[]};e.a=s},ZJd7:function(t,e,a){"use strict";var s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-layout",{staticClass:"treatment-filter blue-grey lighten-5",attrs:{row:"",wrap:""}},[t._l(t.mandatoryTermFilter,function(e,s){return a("v-flex",{key:s,staticClass:"py-2 left-bordered",attrs:{xs12:"",sm4:""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{staticClass:"pl-2",attrs:{xs12:""}},[a("span",{staticClass:"treatment-flag"},[a("v-checkbox",{staticClass:"treatment-flag-checkbox",attrs:{color:"blue darken-1","hide-details":"",small:"",label:e.name},on:{change:function(a){t.onTreatmentChange(e)}},model:{value:e.selected,callback:function(a){t.$set(e,"selected",a)},expression:"treatment.selected"}})],1)])],1),t._l(e.terms,function(s,r){return[a("v-layout",{key:r,staticClass:"pl-4",attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs1:""}},[a("v-checkbox",{staticClass:"treatment-flag-checkbox",attrs:{color:"blue darken-1","hide-details":"",small:"",_label:"term.name"},on:{change:function(a){t.onTermChange(s,e)}},model:{value:s.selected,callback:function(e){t.$set(s,"selected",e)},expression:"term.selected"}})],1),a("v-flex",{staticClass:"caption pr-3",attrs:{xs11:""}},[a("v-divider"),t._v("\n                    "+t._s(s.name)+"\n                ")],1)],1)]})],2)}),t.search.needRefresh?a("v-layout",[a("v-flex",{staticClass:"text-xs-center"},[a("v-btn",{attrs:{flat:""},on:{click:t.onReload}},[a("span",[t._v(t._s(t.$t("Click here to refresh")))]),a("v-icon",[t._v("replay")])],1)],1)],1):t._e()],2)},staticRenderFns:[]};e.a=s},ZvQ6:function(t,e,a){var s=a("myR8");"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a("rjj0")("57d628c1",s,!0,{sourceMap:!1})},a0OY:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("BEFF"),r=a("fDPC");var n=function(t){a("HFgp")},i=a("VU/8")(s.a,r.a,!1,n,null,null);e.default=i.exports},bdDF:function(t,e,a){"use strict";var s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-layout",{staticClass:"user-filter",attrs:{row:"",wrap:"","align-baseline":""}},[a("v-flex",{attrs:{xs9:"",sm5:""}},[a("v-text-field",{attrs:{"append-icon":"search",box:"",color:"silver","hide-details":"",label:t.$t("Surname, Name, Email")},model:{value:t.criteria,callback:function(e){t.criteria=e},expression:"criteria"}})],1),a("v-flex",{attrs:{xs3:"",sm1:""}},[a("v-tooltip",{attrs:{top:""}},[a("v-btn",{attrs:{slot:"activator",flat:"",fab:"",small:""},on:{click:t.onReload},slot:"activator"},[a("v-icon",{attrs:{medium:""}},[t._v("replay")])],1),a("span",{domProps:{textContent:t._s(t.$t("List refresh"))}})],1)],1),a("v-flex",{attrs:{xs12:"",sm5:""}},[a("v-btn-toggle",{staticClass:"user-filter-toggle elevation-0 ",staticStyle:{position:"relative",top:"4px"},model:{value:t.search.toggleValue1,callback:function(e){t.$set(t.search,"toggleValue1",e)},expression:"search.toggleValue1"}},[a("v-btn",{staticClass:"user-filter-date-toggle",attrs:{flat:"",disabled:0==t.search.toggleValue1},on:{click:t.setDateFilter}},[a("v-icon",{staticClass:"mr-1"},[t._v("all_inclusive")]),a("span",{domProps:{textContent:t._s(t.$t("All"))}})],1),a("v-btn",{staticClass:"user-filter-date-toggle",attrs:{flat:"",disabled:1==t.search.toggleValue1},on:{click:t.setDateFilter}},[a("v-icon",{staticClass:"mr-1"},[t._v("today")]),a("span",{domProps:{textContent:t._s(t.$t("Today"))}})],1),a("v-btn",{staticClass:"user-filter-date-toggle",attrs:{flat:"",disabled:2==t.search.toggleValue1},on:{click:t.setDateFilter}},[a("v-icon",{staticClass:"mr-1"},[t._v("calendar_today")]),a("span",{domProps:{textContent:t._s(t.$t("Yesterday"))}})],1)],1)],1)],1)},staticRenderFns:[]};e.a=s},fDPC:function(t,e,a){"use strict";var s={render:function(){var t=this.$createElement;return(this._self._c||t)("UserManager")},staticRenderFns:[]};e.a=s},gTC0:function(t,e,a){"use strict";var s=a("86Ep"),r=a("ZJd7");var n=function(t){a("ZvQ6")},i=a("VU/8")(s.a,r.a,!1,n,null,null);e.a=i.exports},hJJ5:function(t,e,a){"use strict";var s=a("Dd8w"),r=a.n(s),n=a("gTC0"),i=a("LBBD"),o=a("K40v"),l=a("LBi/"),c=a("8Qov"),u=a("NYxO"),d=a("L8MQ"),p=a.n(d);e.a={name:"UserManager",methods:r()({},Object(u.mapActions)("owners/users",["searchList"]),{onShowShareList:function(t){this.adapter=t,this.showShareDialog=!0},onSearch:function(){var t=this.exportFilter,e=t.person,a=t.treatments;a=p()(a).filter(function(t){return t.selected}),this.searchList({person:e,treatments:a})},hideShareDialog:function(){this.showShareDialog=!1}}),computed:r()({},Object(u.mapState)("owners/users",["exportFilter"])),data:function(){return{selectedExportMenuItem:null,showShareDialog:!1,toggleTemporaryFilter:1,adapter:"csv",shareMenuItems:[{title:"Csv Export",adapter:"csv"},{title:"Mailone Export",adapter:"mailone"}]}},components:{GridSearchBar:c.a,ShareListDialog:l.a,TreatmentsFilter:n.a,UserFilter:i.a,UsersGrid:o.a}}},lEY4:function(t,e,a){"use strict";var s=a("mvHQ"),r=a.n(s),n=a("Dd8w"),i=a.n(n),o=a("NYxO"),l=a("Eoz/"),c=a.n(l),u=a("lbHh"),d=a.n(u),p=a("jLWv"),f=a("/5sW"),h=a("L8MQ"),m=a.n(h),v=a("z1+p"),x=a.n(v);e.a={name:"ShareListDialog",watch:{show:function(){this.contactlistName=this.contactlistFileName}},computed:i()({},Object(o.mapState)("owners/users",["exportFilter"]),{contactlistFileName:function(){var t=c()(new Date,"YYYYMMDDTHHmmss"),e=".csv";return"mailone"===this.adapter&&(e=""),this.adapter+"-"+t+e}}),methods:i()({},Object(o.mapActions)("owners/users",["prepareExportList"]),{onCancel:function(){this.$emit("cancel")},onExport:function(){"csv"===this.adapter?this.onExportCsv():"mailone"===this.adapter&&this.onExportMailOne()},completeExportRequest:function(){var t=this.exportFilter,e=t.person,a=t.treatments,s=t.language;return a=m()(a).filter(function(t){return t.selected}),{adapter:this.adapter,contactlistname:this.contactlistName,contactlistemail:"",contactlistreplytoemail:"",filter:{person:e,treatments:a,language:s}}},onExportMailOne:function(){var t=this,e=this.completeExportRequest();this.prepareExportList(e).then(function(e){t.$store.dispatch("api/post",e,{root:!0}).then(function(){}),x()(t.onCancel,10)})},onExportCsv:function(){var t=this,e=this.$auth.getToken(Object(p.a)()),a=e.split("bearer ");if(a.length>0){e=a[1],d.a.set("token",e);var s=this.completeExportRequest();this.prepareExportList(s).then(function(e){t.jsonParams=r()(e.data),t.$refs.exportform.$el.action=e.url,f.default.nextTick(function(){console.log(t.jsonParams)})})}else alert(this.$t("Error"))}}),mounted:function(){this.contactlistName=this.exportFileName},data:function(){return{jsonParams:null,contactlistName:""}},props:{show:{default:!1},adapter:{default:"csv"}}}},myR8:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,".left-bordered{border-right:1px solid #e1e1e1}.treatment-flag-checkbox .input-group--selection-controls__ripple{height:24px;width:24px;left:9px}.treatment-flag-checkbox label{font-size:12px;line-height:20px;color:rgba(0,0,0,.8)!important}.treatment-flag-checkbox .icon{font-size:18px}.treatment-flag-checkbox .input-group--text-field-box .input-group__input,.treatment-flag-checkbox .input-group__input{min-height:20px}",""])},nhZJ:function(t,e,a){"use strict";var s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-toolbar",{staticClass:"py-0 px-4  elevation-1",attrs:{dense:"",color:"white"}},[a("v-text-field",{attrs:{disabled:0==t.list.length,"append-icon":"search",label:t.$t("Filter result set"),"single-line":"","hide-details":""},model:{value:t.search.localCriteria,callback:function(e){t.$set(t.search,"localCriteria",e)},expression:"search.localCriteria"}})],1)},staticRenderFns:[]};e.a=s},phVV:function(t,e,a){"use strict";var s=a("Dd8w"),r=a.n(s),n=a("NYxO");e.a={name:"GridSearchBar",computed:r()({},Object(n.mapState)("owners/users",["list","search","grid"]),Object(n.mapState)("api",["isAjax"]))}},qWik:function(t,e,a){var s=a("JRXP");"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a("rjj0")("5a7f07d4",s,!0,{sourceMap:!1})},tHj3:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,".user-filter-toggle{border:1px solid #e2e2e2}.user-filter-date-toggle.btn--active{background-color:#eee!important;pointer-events:none}",""])},zyW9:function(t,e,a){"use strict";var s=a("Dd8w"),r=a.n(s),n=a("NYxO");t="owners/users";e.a={name:"UsersGrid",methods:{encodedId:function(t){return encodeURI(btoa(t))}},data:function(){var e=[{text:this.$t("Last subscription"),value:"created"},{text:this.$t("Email"),value:"email"},{text:this.$t("Surname"),value:"surname"},{text:this.$t("Name"),value:"name"},{text:this.$t("Actions"),value:"action"}];return{formDateFilter:"2018-05-18",tableTexts:{rowsPerPageText:this.$t("Rows per page"),rowsPerPageItems:[10,20,50,{text:this.$t("All"),value:-1}]},module:t,headers:e}},computed:r()({},Object(n.mapGetters)(t,["filterListByDate"]),Object(n.mapState)(t,["list","search","grid"]),Object(n.mapState)("api",["isAjax"]),{formFilterValidList:function(){return this.validList},validList:function(){return this.filterListByDate.filter?this.filterListByDate.filter(function(t){return t.email&&t.email.includes("@")}):[]}})}}});